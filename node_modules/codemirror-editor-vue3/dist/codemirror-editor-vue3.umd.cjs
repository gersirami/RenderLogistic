(function(u,t){typeof exports=="object"&&typeof module<"u"?t(exports,require("vue"),require("codemirror/lib/codemirror.css"),require("codemirror/addon/fold/foldgutter.css"),require("codemirror/addon/fold/foldcode.js"),require("codemirror/addon/fold/foldgutter.js"),require("codemirror/addon/fold/brace-fold.js"),require("codemirror/addon/selection/active-line.js"),require("codemirror"),require("codemirror/addon/merge/merge.css"),require("codemirror/addon/merge/merge.js"),require("diff-match-patch"),require("codemirror/addon/mode/simple.js")):typeof define=="function"&&define.amd?define(["exports","vue","codemirror/lib/codemirror.css","codemirror/addon/fold/foldgutter.css","codemirror/addon/fold/foldcode.js","codemirror/addon/fold/foldgutter.js","codemirror/addon/fold/brace-fold.js","codemirror/addon/selection/active-line.js","codemirror","codemirror/addon/merge/merge.css","codemirror/addon/merge/merge.js","diff-match-patch","codemirror/addon/mode/simple.js"],t):(u=typeof globalThis<"u"?globalThis:u||self,t(u["codemirror-editor-vue3"]={},u.Vue,null,null,null,null,null,null,u.codemirror,null,null,u.DiffMatchPatch))})(this,function(u,t,ye,ke,we,_e,$e,be,v,Ce,Me,R){"use strict";!window.CodeMirror&&(window.CodeMirror=v);const b=window.CodeMirror||v,H=t.defineComponent({name:"DefaultMode",props:{name:{type:String,default:`cm-textarea-${+new Date}`},value:{type:String,default:""},content:{type:String,default:""},options:{type:Object,default:()=>({})},cminstance:{type:Object,default:()=>null},placeholder:{type:String,default:""}},emits:{ready:e=>e,"update:cminstance":e=>e},setup(e,{emit:n}){const a=t.ref(),r=t.ref(null),o=()=>{r.value=t.markRaw(b.fromTextArea(a.value,e.options)),n("update:cminstance",r.value);const s=t.watch(()=>e.cminstance,l=>{var p;l&&((p=e.cminstance)==null||p.setValue(e.value||e.content)),n("ready",t.unref(r)),s==null||s()},{deep:!0})};return t.onMounted(()=>{o()}),{textarea:a,initialize:o}}}),x=(e,n)=>{const a=e.__vccOpts||e;for(const[r,o]of n)a[r]=o;return a},z=["name","placeholder"];function P(e,n,a,r,o,s){return t.openBlock(),t.createElementBlock("textarea",{ref:"textarea",name:e.$props.name,placeholder:e.$props.placeholder},null,8,z)}const O=x(H,[["render",P]]);window.diff_match_patch=R,window.DIFF_DELETE=-1,window.DIFF_INSERT=1,window.DIFF_EQUAL=0;const U=t.defineComponent({name:"MergeMode",props:{options:{type:Object,default:()=>({})},cminstance:{type:Object,default:()=>({})}},emits:["update:cminstance","ready"],setup(e,{emit:n}){const a=t.ref(),r=t.ref(),o=()=>{a.value=t.markRaw(b.MergeView(r.value,e.options)),n("update:cminstance",a.value),n("ready",a)};return t.onMounted(()=>{o()}),{mergeView:r,initialize:o}}}),W={ref:"mergeView"};function G(e,n,a,r,o,s){return t.openBlock(),t.createElementBlock("div",W,null,512)}const J=x(U,[["render",G]]);var L=(e=>(e.info="info",e.warning="warning",e.error="error",e))(L||{});function T(){const e=new Date,n=e.getHours()<10?`0${e.getHours()}`:e.getHours(),a=e.getMinutes()<10?`0${e.getMinutes()}`:e.getMinutes(),r=e.getSeconds()<10?`0${e.getSeconds()}`:e.getSeconds();return`${n}:${a}:${r}`}function Z(e){return`#link#${JSON.stringify(e)}#link#`}function I(e){const n=/#link#(.+)#link#/g,a=[];let r;for(r=n.exec(e);r;){const o=document.createElement("a"),s=JSON.parse(r[1]),l=Object.entries(s);for(const[p,m]of l)o.setAttribute(p,m);o.className="editor_custom_link",o.innerHTML="logDownload",a.push({start:r.index,end:r.index+r[0].length,node:o}),r=n.exec(e)}return a}function K(e="",n="info"){return`#log<${n}>log#${e}#log<${n}>log#`}function A(e){const n=[];function a(){const r=/#log<(\w*)>log#((.|\r\n|\n)*?)#log<(\w*)>log#/g;let o;for(o=r.exec(e);o;){const l=o[0].replace(/\r\n/g,`
`).split(`
`),m=o[2].replace(/\r\n/g,`
`).split(`
`),f=document.createElement("span"),i=o[1];f.className=`c-editor--log__${i}`;let g=0;for(let c=0;c<l.length;c++){const h=l[c],w=m[c],_=f.cloneNode(!1);_.innerText=w,n.push({start:o.index+g,end:o.index+g+h.length,node:_}),g=g+h.length+1}o=r.exec(e)}}return a(),n}function Q(e,n){return`[${T()}] <${n}> ${e}`}function X(e,n,a){const o=new Array(Math.max(n||15,5)).join(a||"=");return`${o}${e}${o}`}const C=[{regex:/(\[.*?\])([ \t]*)(<error>[ \t])(.+)/,token:["tag","","error.strong","error.strong"],sol:!0},{regex:/(\[.*?\])([ \t]*)(<info>)(.+)(.?)/,token:["tag","","bracket","bracket","hr"],sol:!0},{regex:/(\[.*?\])([ \t]*)(<warning>)(.+)(.?)/,token:["tag","","comment","comment","hr"],sol:!0}];b.defineSimpleMode("fclog",{start:[...C,{regex:/.*/,token:"hr"}],error:[...C,{regex:/.*/,token:"error.strong"}],info:[...C,{regex:/.*/,token:"bracket"}],warning:[...C,{regex:/.*\[/,token:"comment"}]}),b.defineSimpleMode("log",{start:[{regex:/^[=]+[^=]*[=]+/,token:"strong"},{regex:/([^\w])([A-Z][\w]*)/,token:["","string"]},{regex:/(^[A-Z][\w]*)/,token:"string"}]});const Y=t.defineComponent({name:"CodemirrorFclog",props:{value:{type:String,default:""},name:{type:String,default:`cm-textarea-${+new Date}`},options:{type:Object,default:()=>({})},cminstance:{type:Object,default:()=>({})},placeholder:{type:String,default:""}},emits:["update:cminstance","ready"],setup(e,{emit:n}){const a=t.ref(),r=t.ref(null),o=(l=e.cminstance)=>{l.getAllMarks().forEach(i=>i.clear());const m=l.getValue(),f=[].concat(I(m)).concat(A(m));for(let i=0;i<f.length;i++){const g=f[i];l.markText(l.posFromIndex(g.start),l.posFromIndex(g.end),{replacedWith:g.node})}},s=()=>{var l;r.value=t.markRaw(b.fromTextArea(a.value,e.options)),n("update:cminstance",t.unref(r)),(l=r.value)==null||l.on("change",o)};return t.watch(()=>e.cminstance,l=>{var p;l&&(o(e.cminstance),(p=e.cminstance)==null||p.setValue(e.value),n("ready",r))},{deep:!0,immediate:!0}),t.onMounted(()=>{s()}),{initialize:s,textarea:a}}}),ee=["name","placeholder"];function te(e,n,a,r,o,s){return t.openBlock(),t.createElementBlock("textarea",{ref:"textarea",name:e.$props.name,placeholder:e.$props.placeholder},null,8,ee)}const re=x(Y,[["render",te]]),B={"update:value":()=>!0,change:(e,n)=>({value:e,cm:n}),input:()=>!0,ready:e=>e},ne=["changes","scroll","beforeChange","cursorActivity","keyHandled","inputRead","electricInput","beforeSelectionChange","viewportChange","swapDoc","gutterClick","gutterContextMenu","focus","blur","refresh","optionChange","scrollCursorIntoView","update"],oe={...B,...(()=>{const e={};return ne.forEach(n=>{e[n]=(...a)=>a}),e})()},j={mode:"text",theme:"default",lineNumbers:!0,smartIndent:!0,indentUnit:2,styleActiveLine:!0};function ae(e){Promise.resolve().then(()=>{const n=e.getScrollInfo();e.scrollTo(n.left,n.height)})}const se=({props:e,cminstance:n,emit:a,internalInstance:r,content:o})=>{const s=t.computed(()=>{var m;return e.merge?(m=t.unref(n))==null?void 0:m.editor():t.unref(n)}),l=()=>{const m=[];return Object.keys(r==null?void 0:r.vnode.props).forEach(f=>{if(f.startsWith("on")){const i=f.replace(f[2],f[2].toLowerCase()).slice(2);!B[i]&&m.push(i)}}),m};return{listenerEvents:()=>{s.value.on("change",i=>{const g=i.getValue();g===o.value&&g!==""||(o.value=g,a("update:value",o.value||""),a("input",o.value||" "),Promise.resolve().then(()=>{a("change",o.value,i)}),e.keepCursorInEnd&&ae(i))});const m={};l().filter(i=>!m[i]&&(m[i]=!0)).forEach(i=>{s.value.on(i,(...g)=>{a(i,...g)})})}}};function ce({props:e,cminstance:n,presetRef:a}){const r=t.ref("100%"),o=t.ref("100%"),s=t.computed(()=>{var c;return e.merge?(c=t.unref(n))==null?void 0:c.editor():t.unref(n)}),l=()=>{t.nextTick(()=>{var c;(c=s.value)==null||c.refresh()})},p=(c=e.width,h=e.height)=>{var S;let w="",_="";String(c).includes("%")?(_="100%",r.value=String(c)):(_=String(c).replace("px",""),r.value=`${_}px`),String(h).includes("%")?(w="100%",o.value=String(h)):(w=String(h).replace("px",""),o.value=`${w}px`),(S=s.value)==null||S.setSize(_,w)},m=()=>{var h;const c=(h=s.value)==null?void 0:h.getWrapperElement();c==null||c.remove()},f=()=>{var h,w,_;const c=(h=s.value)==null?void 0:h.getDoc().getHistory();(w=a.value)==null||w.initialize(),m(),(_=s.value)==null||_.getDoc().setHistory(c)},i=()=>{const c=document.querySelector(".CodeMirror-gutters");return(c==null?void 0:c.style.left.replace("px",""))!=="0"};return{reload:f,refresh:l,resize:p,destroy:m,containerWidth:r,containerHeight:o,reviseStyle:()=>{if(l(),!i())return;const c=setInterval(()=>{i()?l():clearInterval(c)},60),h=setTimeout(()=>{clearInterval(c),clearTimeout(h)},400)}}}const M=t.defineComponent({__name:"index",props:{value:{type:String,default:""},options:{type:Object,default:()=>j},globalOptions:{type:Object,default:()=>j},placeholder:{type:String,default:""},border:{type:Boolean,default:!1},width:{type:[String,Number],default:null},height:{type:[String,Number],default:null},originalStyle:{type:Boolean,default:!1},keepCursorInEnd:{type:Boolean,default:!1},merge:{type:Boolean,default:!1},name:{type:String,default:""},marker:{type:Function,default:()=>null},unseenLines:{type:Array,default:()=>[]}},emits:oe,setup(e,{expose:n,emit:a}){var V,q,F;typeof Object.assign!="function"&&Object.defineProperty(Object,"assign",{value(d){if(d==null)throw new TypeError("Cannot convert undefined or null to object");const y=Object(d);for(let k=1;k<arguments.length;k++){const $=arguments[k];if($!=null)for(const E in $)Object.prototype.hasOwnProperty.call($,E)&&(y[E]=$[E])}return y},writable:!0,configurable:!0});const r=e,o=a,s=t.ref(null),l=t.ref(""),p=t.shallowRef(O),m=t.ref({foldGutter:!0,...j,...r.globalOptions,...r.options,gutters:[...new Set(["CodeMirror-linenumbers","CodeMirror-foldgutter",...((V=r.options)==null?void 0:V.gutters)||[]])]}),f=t.getCurrentInstance(),i=r.name||((F=(q=f==null?void 0:f.parent)==null?void 0:q.type)==null?void 0:F.name)||void 0,g=t.ref(null),c=t.computed(()=>{var d;return r.merge?(d=t.unref(s))==null?void 0:d.editor():t.unref(s)}),{refresh:h,resize:w,destroy:_,containerHeight:S,containerWidth:ue,reviseStyle:me}=ce({props:r,cminstance:s,presetRef:g}),{listenerEvents:fe}=se({props:r,cminstance:s,emit:o,internalInstance:f,content:l}),N=()=>{r.unseenLines!==void 0&&r.marker!==void 0&&r.unseenLines.forEach(d=>{var k,$;const y=(k=s.value)==null?void 0:k.lineInfo(d);($=s.value)==null||$.setGutterMarker(d,"breakpoints",y!=null&&y.gutterMarkers?null:r.marker())})},ge=d=>{var k,$;const y=(k=s.value)==null?void 0:k.getValue();d!==y&&(($=s.value)==null||$.setValue(d),l.value=d,me()),N()},pe=()=>{fe(),N(),w(r.width,r.height),o("ready",s.value),t.watch([()=>r.width,()=>r.height],([d,y])=>{w(d,y)},{deep:!0})},he=()=>{if(r.options.mode==="fclog"||r.options.mode==="log"){p.value=re;return}if(r.merge){p.value=J;return}p.value=O};return t.watch(()=>r.options,d=>{var y;for(const k in r.options)(y=c.value)==null||y.setOption(k,t.unref(d[k]))},{deep:!0}),t.watch(()=>r.value,d=>{ge(d)}),t.watch(()=>r.merge,he,{immediate:!0}),t.onBeforeUnmount(()=>{_()}),n({cminstance:s,resize:w,refresh:h,destroy:_}),(d,y)=>(t.openBlock(),t.createElementBlock("div",{class:t.normalizeClass(["codemirror-container",{merge:d.$props.merge,bordered:d.$props.border||d.$props.merge&&!r.originalStyle,"original-style":r.originalStyle}]),style:t.normalizeStyle({height:t.unref(S),width:t.unref(ue)})},[(t.openBlock(),t.createBlock(t.resolveDynamicComponent(p.value),t.mergeProps({ref_key:"presetRef",ref:g,cminstance:s.value,"onUpdate:cminstance":y[0]||(y[0]=k=>s.value=k),style:{height:"100%"}},{...d.$props,...d.$attrs,options:m.value,name:t.unref(i),content:l.value},{onReady:pe}),null,16,["cminstance"]))],6))}}),D=(e,n)=>(n&&n.options&&(M.props.globalOptions.default=()=>n.options),e.component((n==null?void 0:n.componentName)||"Codemirror",M),e),le=window.CodeMirror||b,ie=D,de=D;function styleInject(css,ref){if(ref===void 0){ref={}}var insertAt=ref.insertAt;if(!css||typeof document==="undefined"){return}var head=document.head||document.getElementsByTagName("head")[0];var style=document.createElement("style");style.type="text/css";if(insertAt==="top"){if(head.firstChild){head.insertBefore(style,head.firstChild)}else{head.appendChild(style)}}else{head.appendChild(style)}if(style.styleSheet){style.styleSheet.cssText=css}else{style.appendChild(document.createTextNode(css))}};styleInject(`.codemirror-container {
  position: relative;
  display: inline-block;
  height: 100%;
  width: fit-content;
  font-size: 13px;
  overflow: hidden;
}
.codemirror-container.bordered {
    border: 1px solid #aaaaaa;
}

.codemirror-container .editor_custom_link {
  cursor: pointer;
  color: #1474f1;
  text-decoration: underline;
}
.codemirror-container .editor_custom_link:hover {
  color: #04b4fa;
}
.codemirror-container:not(.original-style) .CodeMirror-lines .CodeMirror-placeholder.CodeMirror-line-like {
  color: #666;
}
.codemirror-container:not(.original-style) .CodeMirror,
.codemirror-container:not(.original-style) .CodeMirror-merge-pane {
  height: 100%;
  font-family: consolas !important;
}
.codemirror-container:not(.original-style) .CodeMirror-merge,
.codemirror-container:not(.original-style) .CodeMirror-merge-right .CodeMirror {
  height: 100%;
  border: none !important;
}
.codemirror-container:not(.original-style) .c-editor--log__error {
  color: #bb0606;
  font-weight: bold;
}
.codemirror-container:not(.original-style) .c-editor--log__info {
  color: #333333;
  font-weight: bold;
}
.codemirror-container:not(.original-style) .c-editor--log__warning {
  color: #ee9900;
}
.codemirror-container:not(.original-style) .c-editor--log__success {
  color: #669600;
}
.codemirror-container:not(.original-style) .cm-header,
.codemirror-container:not(.original-style) .cm-strong {
  font-weight: bold;
}
`),u.CodeMirror=le,u.GlobalCmComponent=ie,u.InstallCodemirro=de,u.VueCodemirror=M,u.createLinkMark=Z,u.createLog=Q,u.createLogMark=K,u.createTitle=X,u.default=M,u.getLinkMarks=I,u.getLocalTime=T,u.getLogMark=A,u.logErrorType=L,Object.defineProperties(u,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
